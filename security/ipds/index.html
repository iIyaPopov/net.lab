
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../containers/docker%2Bgns3/">
      
      
        <link rel="next" href="../../other/iperf3/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>IPDS - net.lab</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Nunito";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#idps-suricata" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="net.lab" class="md-header__button md-logo" aria-label="net.lab" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            net.lab
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              IPDS
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="net.lab" class="md-nav__button md-logo" aria-label="net.lab" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    net.lab
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../stand/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    üõ†Ô∏è –°—Ç–µ–Ω–¥
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üåê –°–µ—Ç–∏
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            üåê –°–µ—Ç–∏
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/vpcs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    –ü–µ—Ä–≤–∞—è —Å—Ö–µ–º–∞ –≤ GNS3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/switch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    –ö–æ–º–º—É—Ç–∞—Ç–æ—Ä
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/router/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/subnets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø–æ–¥—Å–µ—Ç–∏
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/static-routing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/ipv6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IPv6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/icmp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ICMP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/vlan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VLAN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/fhrp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FHRP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/tcp-udp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TCP/UDP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/acl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ACL
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/nat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NAT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/dhcp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DHCP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/mstp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MSTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/rip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RIP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/ospf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSPF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../network/wlan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WLAN
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üö¢ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            üö¢ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è –∏ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../containers/docker%2Bgns3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker + GNS3
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    IPDS
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    IPDS
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      –£—Å—Ç–∞–Ω–æ–≤–∫–∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –ø—Ä–∞–≤–∏–ª
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      –ó–∞–ø—É—Å–∫
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      –ù–∞—Å—Ç—Ä–æ–π–∫–∞
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∞">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      –ê–¥—Ä–µ—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π (–¥–æ–º–∞—à–Ω–µ–π) —Å–µ—Ç–∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      –§–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∞–≤–∏–ª–∞
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä—ã
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–ü—Ä–∏–º–µ—Ä—ã">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä 3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä 4
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ips" class="md-nav__link">
    <span class="md-ellipsis">
      –†–µ–∂–∏–º IPS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      üß∞ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üß∞ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      –£—Å–ª–æ–≤–∏—è
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      ü§î –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    üóÉÔ∏è –ü—Ä–æ—á–µ–µ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            üóÉÔ∏è –ü—Ä–æ—á–µ–µ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../other/iperf3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iperf3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../other/mkdocs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MkDocs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../other/jupyter-notebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Jupyter Notenetwork
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    –û —Å–∞–π—Ç–µ
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      –£—Å—Ç–∞–Ω–æ–≤–∫–∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –ø—Ä–∞–≤–∏–ª
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      –ó–∞–ø—É—Å–∫
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      –ù–∞—Å—Ç—Ä–æ–π–∫–∞
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–ù–∞—Å—Ç—Ä–æ–π–∫–∞">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      –ê–¥—Ä–µ—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π (–¥–æ–º–∞—à–Ω–µ–π) —Å–µ—Ç–∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      –§–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∞–≤–∏–ª–∞
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä—ã
    </span>
  </a>
  
    <nav class="md-nav" aria-label="–ü—Ä–∏–º–µ—Ä—ã">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä 1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä 2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä 3
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      –ü—Ä–∏–º–µ—Ä 4
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ips" class="md-nav__link">
    <span class="md-ellipsis">
      –†–µ–∂–∏–º IPS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      üß∞ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üß∞ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      –£—Å–ª–æ–≤–∏—è
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      ü§î –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<style>
    .author {
        color: gray;
        font-size: 0.6rem;
        text-align: right;
    }
</style>

<div class="author">
–ê–≤—Ç–æ—Ä: –ò. –ü–æ–ø–æ–≤
</div>

<h1 id="idps-suricata">–ó–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å —Å–∏—Å—Ç–µ–º–∞–º–∏ IDPS –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ Suricata</h1>
<h2 id="_1">–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ —Å–≤–µ–¥–µ–Ω–∏—è</h2>
<p>–≠—Ç–æ IDPS-—Å–∏—Å—Ç–µ–º–∞ (–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∞—Ç–∞–∫), —Å–ø–æ—Å–æ–±–Ω–∞—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å–µ—Ç–µ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤.</p>
<ul>
<li>
<p><a href="https://docs.suricata.io/en/latest/">üìë <strong>–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</strong></a> –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ. –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∞ –∫ –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—é.</p>
</li>
<li>
<p>üßë‚Äçüî¨ –í—Å–µ –æ–ø–∏—Å–∞–Ω–Ω–æ–µ <strong>–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ</strong> –Ω–∞ Debain 11.7 (Proxmox 8 LXC), Suricata 6.0.1 RELEASE.</p>
</li>
</ul>
<h3 id="_2">–£—Å—Ç–∞–Ω–æ–≤–∫–∞</h3>
<div class="highlight"><pre><span></span><code>apt update
apt install suricata
</code></pre></div>
<p>–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–µ—Ä—Å–∏—é</p>
<div class="highlight"><pre><span></span><code>suricata -V
</code></pre></div>
<h3 id="_3">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –ø—Ä–∞–≤–∏–ª</h3>
<p>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª. –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤) —É–∂–µ –∫–µ–º-—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª</p>
<div class="highlight"><pre><span></span><code>suricata-update
</code></pre></div>
<p>–í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏–≤—à–∏—Å—å —Å –≤—ã–≤–æ–¥–æ–º, –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É <code>suricata.rules</code> (–¥–∞–ª–µ–µ –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è, —á—Ç–æ–±—ã –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –æ—à–∏–±–∫–∏).</p>
<p>–î–∞–Ω–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –Ω–µ—Ç—Ä–µ–±–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –º–æ–≥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–æ–±—ã—Ç–∏–π –≤ –ª–æ–≥-—Ñ–∞–π–ª–∞—Ö.</p>
<h3 id="_4">–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º</h3>
<p>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏ —Ñ–∞–π–ª–æ–≤ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫</p>
<div class="highlight"><pre><span></span><code>suricata -T -c /etc/suricata/suricata.yaml
</code></pre></div>
<div class="admonition warning">
<div class="highlight"><pre><span></span><code>&lt;Warning&gt; - [ERRCODE: SC_ERR_NO_RULES(42)] - No rule files match the pattern /etc/suricata/rules/suricata.rules
</code></pre></div>
<p>‚ö†Ô∏è <strong>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.</strong> –§–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω. –ù–µ —Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–µ–Ω–∏–µ, –∞ –Ω–µ –æ—à–∏–±–∫–∞, –æ—Ç –Ω–µ–≥–æ –ª—É—á—à–µ –∏–∑–±–∞–≤–∏—Ç—å—Å—è.</p>
</div>
<p>–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –ª—É—á—à–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫.</p>
<h3 id="_5">–ó–∞–ø—É—Å–∫</h3>
<p>–° –ø–æ–º–æ—â—å—é <code>systemctl</code> –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–µ—Ä–≤–∏—Å–æ–º <code>suricata.service</code>, –Ω–∞–ø—Ä–∏–º–µ—Ä,–ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å - <code>systemctl restart suricata.service</code>.</p>
<p>–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã <code>suricata ...</code> –∑–∞–ø—É—Å–∫–∞—Ç—å —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</p>
<ul>
<li><code>-D</code> - —Ä–µ–∂–∏–º –¥–µ–º–æ–Ω–∞</li>
<li><code>-c</code> - –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É <code>.conf</code></li>
<li><code>q &lt;—á–∏—Å–ª–æ&gt;</code> - –∑–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ IPS (—Ç—Ä–µ–±—É–µ—Ç—Å—è firewall, –Ω–∞–ø—Ä–∏–º–µ—Ä, iptables)</li>
</ul>
<p>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª–µ <code>/etc/systemd/system/multiuser.target/suricata.service</code>. –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –∫–æ–ø–∏—é. –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è <code>systemctl daemon-reload</code>.</p>
<h3 id="_6">–ù–∞—Å—Ç—Ä–æ–π–∫–∞</h3>
<h4 id="_7">–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤</h4>
<p>–ö–∞—Ç–∞–ª–æ–≥ —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ - <code>/etc/suricata</code>.</p>
<p>–ö–∞—Ç–∞–ª–æ–≥ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ - <code>/etc/suricata/rules</code> –∏ <code>/var/lib/suricata/rules</code>.</p>
<p>–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ - <code>suricata.yaml</code>.</p>
<p>–ö–∞—Ç–∞–ª–æ–≥ —Å –ª–æ–≥–∞–º–∏ - <code>/var/log/suricata</code>.</p>
<p>–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞.</p>
<h4 id="_8">–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞</h4>
<p>–í <code>/etc/suricata/suricata.yaml</code> –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å—Å—è —Ç—Ä–∞—Ñ–∏–∫ (–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ - <code>ip a</code>)</p>
<div class="highlight"><pre><span></span><code>af-packet:
    - interface: &lt;–∏–º—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞&gt;
</code></pre></div>
<h4 id="_9">–ê–¥—Ä–µ—Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π (–¥–æ–º–∞—à–Ω–µ–π) —Å–µ—Ç–∏</h4>
<p>–ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π <code>HOME_NET</code> –≤ <code>/etc/suricata/suricata.yaml</code> –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∞–¥—Ä–µ—Å–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π (–¥–æ–º–∞—à–Ω–µ–π) —Å–µ—Ç–∏. –î–∞–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –Ω–æ–º–µ—Ä–∞ –≤–∞—à–µ–π –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏. –°–µ—Ç–µ–π –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —É–∂–µ –µ—Å—Ç—å —Å–µ—Ç–∏ –∏–∑ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤.</p>
<div class="highlight"><pre><span></span><code>address-groups:
    HOME_NET: &quot;[192.168.0.0/16,10.0.0.0/8,172.16.0.0/12]&quot;
</code></pre></div>
<p>–î–∞–Ω–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø—Ä–∞–≤–∏–ª–∞—Ö.</p>
<h4 id="_10">–§–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏</h4>
<p>–í <code>suricata.yaml</code> –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è –≤—Å–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏.</p>
<p>–°–æ–±–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä, <code>local.rules</code> (–∏–ª–∏ –ª–æ–≥–∏—á–µ—Å–∫–∏ —Ä–∞–∑–¥–µ–ª—è—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤, –Ω–∞–ø—Ä–∏–º–µ—Ä, <code>local-web.rules</code>). –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ –Ω–∏–º.</p>
<div class="highlight"><pre><span></span><code>default-rule-path: &lt;–ø—É—Ç—å –∫ –∫–∞—Ç–∞–ª–æ–≥—É —Å —Ñ–∞–π–ª–∞–º–∏ —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏&gt;

rule-files:
  - &lt;—Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ 1&gt;
  - &lt;—Ñ–∞–π–ª —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ 2&gt;
  - ...
</code></pre></div>
<h4 id="_11">–ü—Ä–∞–≤–∏–ª–∞</h4>
<p><strong>–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</strong></p>
<div class="highlight"><pre><span></span><code>&lt;–¥–µ–π—Å—Ç–≤–∏–µ&gt; &lt;–ø—Ä–æ—Ç–æ–∫–æ–ª&gt; &lt;src IP&gt; &lt;src port&gt; [-&gt;|&lt;&gt;] &lt;dest IP&gt; &lt;dest port&gt; (&lt;–∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ&gt;: &lt;–∑–Ω–∞—á–µ–Ω–∏–µ&gt;; ...)
</code></pre></div>
<p>–ö –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å:</p>
<ul>
<li>–∏–Ω–≤–µ—Ä—Å–∏—é —Å –ø–æ–º–æ—â—å—é —Å–∏–º–≤–æ–ª–∞ <code>!</code></li>
<li>–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ <code>[&lt;–∑–Ω–∞—á–µ–Ω–∏–µ 1&gt;, &lt;–∑–Ω–∞—á–µ–Ω–∏–µ 2&gt;, ...]</code></li>
</ul>
<p>—á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω–æ–≥–¥–∞ —É–¥–æ–±–Ω–æ.</p>
<p><strong>–û—Å–Ω–æ–≤–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</strong></p>
<ul>
<li><code>alert</code> - –æ–ø–æ–≤–µ—Å—Ç–∏—Ç—å</li>
<li><code>pass</code> - –∑–∞–∫–æ–Ω—á–∏—Ç—å –∞–Ω–∞–ª–∏–∑ —Ç—Ä–∞—Ñ–∏–∫–∞ (–ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å)</li>
<li><code>drop</code> - –æ—Ç–±—Ä–æ—Å–∏—Ç—å –±–µ–∑ –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å alert</li>
<li><code>reject</code> - –æ—Ç–±—Ä–æ—Å–∏—Ç—å —Å –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ–º</li>
<li>–µ—Å—Ç—å –µ—â–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</li>
</ul>
<p><strong>–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤</strong></p>
<ul>
<li><code>ip</code></li>
<li><code>icmp</code></li>
<li><code>tcp</code></li>
<li><code>udp</code></li>
<li><code>dns</code></li>
<li><code>ssh</code></li>
<li><code>http</code></li>
<li>–µ—Å—Ç—å –µ—â–µ –º–Ω–æ–≥–æ –¥—Ä—É–≥–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤</li>
</ul>
<p><strong>–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–∞—Ñ–∏–∫–∞</strong></p>
<p>–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –≤ –∫–∞–∫–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª–æ</p>
<ul>
<li><code>-&gt;</code> - –æ–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ (—Å—Ç—Ä–µ–ª–∫–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, —ç—Ç–æ –≤–∞–∂–Ω–æ)</li>
<li><code>&lt;&gt;</code> - –¥–≤—É–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ</li>
</ul>
<p>–î–∞–ª–µ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Ç–∞-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ—á–∏—Å–ª—è—é—Ç—Å—è –≤ <code>(...)</code> –ø—Ä–∞–≤–∏–ª–∞. –ù–µ –≤—Å–µ –∏–∑ –Ω–∏—Ö —è–≤–ª—è—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏.</p>
<div class="admonition warning">
<p>‚ö†Ô∏è <strong>–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ.</strong> –î–ª—è —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –µ—â–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã. –°–º. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é.</p>
</div>
<p><strong>msg</strong></p>
<p>–¢–µ–∫—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –∏ –≤–æ–∑–º–æ–∂–Ω–æ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–∏.</p>
<p><strong>sid</strong></p>
<p>–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞—Ç—É—Ä—ã. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–∏ id <a href="https://sidallocation.org/">–∑–¥–µ—Å—å</a>.</p>
<p><strong>rev</strong></p>
<p>–ù–æ–º–µ—Ä –≤–µ—Ä—Å–∏–∏ –ø—Ä–∞–≤–∏–ª–∞. –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å <strong>sid</strong>. –ü—Ä–∏ –µ–≥–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å —á–∏—Å–ª–æ.</p>
<p><strong>classtype</strong></p>
<p>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∞—Å—Å–µ –ø—Ä–∞–≤–∏–ª–∞. –§–∞–π–ª, –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –∫–ª–∞—Å—Å—ã - <code>classification.config</code>.</p>
<p>–°–∏–Ω—Ç–∞–∫—Å–∏—Å</p>
<div class="highlight"><pre><span></span><code>config classification: &lt;–∫–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ&gt;,&lt;–ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ&gt;,&lt;–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é&gt;
</code></pre></div>
<p>–ù–∞–ø—Ä–∏–º–µ—Ä,</p>
<div class="highlight"><pre><span></span><code>config classification: web-application-attack,Web Application Attack,1
</code></pre></div>
<p><strong>reference</strong></p>
<p>–£–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –º–µ—Å—Ç–æ, –≥–¥–µ –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∏–≥–Ω–∞—Ç—É—Ä–µ –∏ –ø—Ä–æ–±–ª–µ–º–µ. –ú–æ–∂–µ—Ç –±—ã—Ç—å —É–∫–∞–∑–∞–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑.</p>
<p>–ù–∞–ø—Ä–∏–º–µ—Ä, </p>
<div class="highlight"><pre><span></span><code>reference: url, www.example.com
reference: cve, CVE-2024-0001
</code></pre></div>
<p><strong>priority</strong></p>
<p>–ü—Ä–∏–æ—Ä–∏–µ—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –Ω–∞–∏–±–æ–ª—å—à–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.</p>
<p>–î–∏–∞–ø–∞–∑–æ–Ω –∑–Ω–∞—á–µ–Ω–∏–π –æ—Ç 1 –¥–æ 255. –ß–∞—â–µ –≤—Å–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –æ—Ç 1 –¥–æ 4.</p>
<p><strong>metadata</strong></p>
<p>–ü—Ä–æ—á–∞—è –ø–æ–ª–µ–∑–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ</p>
<div class="highlight"><pre><span></span><code>metadata: &lt;–∫–ª—é—á&gt; &lt;–∑–Ω–∞—á–µ–Ω–∏–µ&gt;, &lt;–∫–ª—é—á&gt; &lt;–∑–Ω–∞—á–µ–Ω–∏–µ&gt;;
</code></pre></div>
<p>–ù–µ —è–≤–ª—è–µ—Ç—Å—è —Å–ª—É–∂–µ–±–Ω–æ–π –¥–ª—è Suricata.</p>
<p><strong>threshold</strong></p>
<div class="highlight"><pre><span></span><code>threshold: type { threshold | limit }, track { by_src | by_dst | by_both }, count &lt;value&gt;, seconds &lt;value&gt;;
</code></pre></div>
<p>–°–º. –ø–æ–ª–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏.</p>
<h3 id="_12">–ü—Ä–∏–º–µ—Ä—ã</h3>
<h4 id="1">–ü—Ä–∏–º–µ—Ä 1</h4>
<p>–í –ø—Ä–∏–º–µ—Ä–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –æ –ª—é–±–æ–º "–ø–∏–Ω–≥–µ", –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫ Suricata –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –æ—Ç –Ω–µ–µ.</p>
<div class="highlight"><pre><span></span><code>alert icmp any any -&gt; any any (msg:&quot;My rule 1&quot;; sid:1000001; rev:1;)
</code></pre></div>
<p>–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å "–ø–∏–Ω–≥" –≤ —Å—Ç–æ—Ä–æ–Ω—É Suricata –∏–ª–∏ –æ—Ç –Ω–µ–µ.</p>
<p>–ü—Ä–∏ —ç—Ç–æ–º –≤ —Ñ–∞–π–ª–µ <code>/var/log/suricata/fast.log</code> –ø–æ—è–≤—è—Ç—Å—è –ª–æ–≥–∏ —Å –≤–∞—à–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º</p>
<div class="highlight"><pre><span></span><code>tail /var/log/suricata/fast.log
</code></pre></div>
<h4 id="2">–ü—Ä–∏–º–µ—Ä 2</h4>
<p>–í –ø—Ä–∏–º–µ—Ä–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –Ω–∞ web-—Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å—Ç—Ä–æ–∫–∏, —É–∫–∞–∑–∞–Ω–Ω–æ–π –≤ –ø–æ–ª–µ <code>content</code></p>
<div class="highlight"><pre><span></span><code>alert http any any -&gt; any any (msg:&quot;My rule 2&quot;; content:&quot;malicious&quot;; sid:1000002; rev:1;)
</code></pre></div>
<p>–ß—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å HTTP-–∑–∞–ø—Ä–æ—Å —Å Suricata –Ω–∞ –ª—é–±–æ–π —Å–∞–π—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç HTTP –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —É–∫–∞–∑–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É</p>
<p>–ù–∞–ø—Ä–∏–º–µ—Ä, </p>
<div class="highlight"><pre><span></span><code>curl http://testmynids.org [ &gt; /dev/null ]
</code></pre></div>
<h4 id="3">–ü—Ä–∏–º–µ—Ä 3</h4>
<p>–í –ø—Ä–∏–º–µ—Ä–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –æ–ø–æ–≤–µ—â–µ–Ω–∏–µ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –≤–µ–±-—Å–µ–≤–µ—Ä—É –ø–æ URI, –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—â–µ–º—É —Å <code>/uid/index.html</code></p>
<div class="highlight"><pre><span></span><code>alert http any any -&gt; any any (msg:&quot;My rule 3&quot;; http.uri; content:!&quot;/uid/index.html&quot;; sid:1000001; rev:1;)
</code></pre></div>
<p>–î–∞–Ω–Ω—ã–π –≤—ã–∑–æ–≤ <strong>–Ω–µ</strong> –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –ø–æ—è–≤–ª–µ–Ω–∏—é –æ–ø–æ–≤–µ—â–µ–Ω–∏—è</p>
<div class="highlight"><pre><span></span><code>curl http://testmynids.org/uid/index.html
</code></pre></div>
<p>–î–∞–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã –ø—Ä–∏–≤–µ–¥—É—Ç –∫ –ø–æ—è–≤–ª–µ–Ω–∏—é –æ–ø–æ–≤–µ—â–µ–Ω–∏—è</p>
<div class="highlight"><pre><span></span><code>curl http://testmynids.org/
curl http://testmynids.org/uid/index.html
</code></pre></div>
<h4 id="4">–ü—Ä–∏–º–µ—Ä 4</h4>
<p>–í –ø—Ä–∏–º–µ—Ä–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –ø—Ä–∏ ICMP-—Å–æ–æ–±—â–µ–Ω–∏—è—Ö —Ä–∞–∑ –≤ –º–∏–Ω—É—Ç—É, –µ—Å–ª–∏ –±—ã–ª–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –º–∏–Ω–∏–º—É–º 3 –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.</p>
<div class="highlight"><pre><span></span><code>alert icmp any any -&gt; any any (msg:&quot;My rule 1&quot;; threshold: type threshold, track by_src, count 3, seconds 60; sid:1000001; rev:1;)
</code></pre></div>
<p>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–º. <a href="https://docs.suricata.io/en/suricata-7.0.2/configuration/global-thresholds.html">–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é</a>.</p>
<h3 id="ips">–†–µ–∂–∏–º IPS</h3>
<p>–¢—Ä–µ–±—É–µ—Ç—Å—è firewall, –Ω–∞–ø—Ä–∏–º–µ—Ä, iptables</p>
<div class="highlight"><pre><span></span><code>apt install iptables
</code></pre></div>
<p>–°–æ–∑–¥–∞—Ç—å –≤—Ö–æ–¥—è—â–µ–µ, –∏—Å—Ö–æ–¥—è—â–µ–µ –∏–ª–∏ —Ç—Ä–∞–Ω–∑–∏—Ç–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ</p>
<div class="highlight"><pre><span></span><code>iptables -I [ INPUT | OUTPUT | FORWARD ] [ -p &lt;protocol&gt; ] [ ... ] -j NFQUEUE [ --queue-num 0 ] [ --queue-bypass ]
</code></pre></div>
<div class="admonition tip">
<p><strong>üí° –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è.</strong> <code>NFQUEUE</code> - —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π target –≤ iptables, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø–æ —Å–µ—Ç–µ–≤—ã–º –ø–∞–∫–µ—Ç–∞–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ (–≤ –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ - Suricata).</p>
</div>
<p><code>-q 0</code> - –æ–ø—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ Suricata –≤ —Ä–µ–∂–∏–º–µ IPS.</p>
<p><code>--queue-bypass</code> - —Ä–µ—à–µ–Ω–∏–µ –æ –¥–∞–ª—å–Ω–µ–π—à–µ–π —Å—É–¥—å–±–µ –ø–∞–∫–µ—Ç–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç iptables, –µ—Å–ª–∏ –≤ Suricata –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø—Ä–∞–≤–∏–ª–∞.</p>
<p>–í —Ä–µ–∂–∏–º–µ IPS –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏ drop/reject.</p>
<h2 id="_13">üß∞ –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞</h2>
<details class="info">
<summary>–û–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º</summary>
<ul>
<li>–í–º–µ—Å—Ç–æ ‚ùî –∏–ª–∏ <code>x</code> –Ω—É–∂–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å —Å–≤–æ–π –Ω–æ–º–µ—Ä –ø–æ –∂—É—Ä–Ω–∞–ª—É</li>
<li>–í—ã–ø–æ–ª–Ω—è—Ç—å –∑–∞–¥–∞–Ω–∏–µ –±–µ–∑ "–æ—Ç–º–∞—à–∫–∏" <strong>–Ω–µ —Å—Ç–æ–∏—Ç</strong> ‚õî, —Ç.–∫. –∑–∞–¥–∞–Ω–∏–µ –∑–¥–µ—Å—å –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏</li>
<li>–£ –∫–∞–∂–¥–æ–π —Ä–∞–±–æ—Ç—ã –µ—Å—Ç—å <strong>—Å—Ä–æ–∫ —Å–¥–∞—á–∏</strong> üìÖ, –∫–æ—Ç–æ—Ä—ã–π –æ–∑–≤—É—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –∑–∞–Ω—è—Ç–∏–∏, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ä–∞–±–æ—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞—â–∏—â–µ–Ω–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª üìâ</li>
<li><strong>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</strong> üìö  –Ω–µ —è–≤–ª—è—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏, –Ω–æ –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —Å–¥–∞—á–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–¥–∞–Ω–æ –æ–¥–Ω–æ –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–∑ –Ω–∏—Ö. –¢–∞–∫–∂–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞–Ω–æ <strong>—É—Å—Ç–Ω–æ</strong></li>
<li>–î–ª—è –∫–∞–∂–¥–æ–π –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å <strong>–æ—Ç—á–µ—Ç</strong> üìù —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∞—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π, –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º (—Å–º. –Ω–∞ —Å–∞–π—Ç–µ —É—á–µ–±–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è)</li>
<li>–ù—É–∂–Ω–æ —É–º–µ—Ç—å –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ <strong>–≤–æ–ø—Ä–æ—Å—ã</strong> ‚ùì –ø–æ —Ç–µ–º–µ, –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –¥—Ä—É–≥–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã</li>
<li>–ü—Ä–∏–º–µ—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω—ã <strong>–ø–æ –∂–µ–ª–∞–Ω–∏—é</strong>, –∞ —Ç–∞–∫–∂–µ –≤—ã–¥–∞–Ω—ã –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –∏–ª–∏ –±–µ–∑ <strong>–≤ —Å–ª—É—á–∞–µ –Ω–µ—É—Å–ø–µ—à–Ω–æ–π üò¢ –∑–∞—â–∏—Ç—ã –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã</strong></li>
<li>–ò–Ω–æ–≥–¥–∞ –≤ —Ä–∞–±–æ—Ç–∞—Ö –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –∑–∞–¥–∞–Ω–∏—è –ø–æ <strong>IPv4 –∏ IPv6</strong> –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ üîó. –≠—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ <strong>–æ–¥–Ω–∞ —Ä–∞–±–æ—Ç–∞</strong>. –î–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Å–¥–∞—á–∞ —Ä–∞–±–æ—Ç—ã —Ç–æ–ª—å–∫–æ —Å IPv4 –∏–ª–∏ —Ç–æ–ª—å–∫–æ —Å IPv6, –Ω–æ <strong>–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–ª</strong> –≤ —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ <strong>–ø–æ–ª—É—á–∏—Ç—å –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ</strong></li>
</ul>
</details>
<p><strong>üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã:</strong> –∏–∑—É—á–∏—Ç—å –ø—Ä–æ—Å—Ç—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É IPDS-—Å–∏—Å—Ç–µ–º—ã –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–≤ ICMP, HTTP, DNS.</p>
<h3 id="_14">–£—Å–ª–æ–≤–∏—è</h3>
<ol>
<li>–û–¥–Ω–∞ VM —Å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–º (apache –∏–ª–∏ nginx) –∏ IDPS (suricata).</li>
<li>–°–≤–æ–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä —Å–æ —Å–≤–æ–∏–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ <code>index.html</code>, <code>books.html</code>, <code>authors.html</code>. –ù–∞–ø–æ–ª–Ω–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ—Å—Ç—ã–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º.</li>
<li>–ö–ª–∏–µ–Ω—Ç –∏ VM (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä + IDPS) –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö —Å–µ—Ç—è—Ö.</li>
<li>
<p>–ü—Ä–∞–≤–∏–ª–∞</p>
<ol>
<li>IDS –¥–æ–ª–∂–Ω–∞ –æ–ø–æ–≤–µ—â–∞—Ç—å –æ –ª—é–±—ã—Ö ICMP-–∑–∞–ø—Ä–æ—Å–∞—Ö –≤ —Å—Ç–æ—Ä–æ–Ω—É –≤–∞—à–µ–π VM.</li>
<li><strong>–î–ª—è –æ—Ü–µ–Ω–∫–∏ –≤—ã—à–µ 3.</strong> IDS –¥–æ–ª–∂–Ω–∞ –æ–ø–æ–≤–µ—â–∞—Ç—å –æ –ª—é–±—ã—Ö ICMP-–∑–∞–ø—Ä–æ—Å–∞—Ö –≤ —Å—Ç–æ—Ä–æ–Ω—É VM, –µ—Å–ª–∏ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ 10 –∏–ª–∏ –±–æ–ª–µ–µ –∑–∞ 30 —Å–µ–∫—É–Ω–¥.</li>
<li>IDS –¥–æ–ª–∂–Ω–∞ –æ–ø–æ–≤–µ—â–∞—Ç—å –æ HTTP-–∑–∞–ø—Ä–æ—Å–∞—Ö –ø–æ URI, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ.</li>
<li>
<p><strong>–î–ª—è –æ—Ü–µ–Ω–∫–∏ –≤—ã—à–µ 3.</strong> IDS –¥–æ–ª–∂–Ω–∞ –æ–ø–æ–≤–µ—â–∞—Ç—å –æ –ª—é–±—ã—Ö HTTP-–∑–∞–ø—Ä–æ—Å–∞—Ö –Ω–∞ –≤–∞—à –≤–µ–±-—Å–µ—Ä–≤–µ—Ä, –µ—Å–ª–∏ –∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ –º–µ–Ω–µ–µ 5 –≤ –º–∏–Ω—É—Ç—É. </p>
<blockquote>
<p><strong>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞.</strong> –°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –∏–∑—É—á–∏—Ç—å –≤ Wireshark –æ–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏, —Ç.–∫. –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è HTTP –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.</p>
</blockquote>
</li>
<li>
<p>IDS –¥–æ–ª–∂–Ω–∞ –æ–ø–æ–≤–µ—â–∞—Ç—å –æ –ª—é–±—ã—Ö DNS-–∑–∞–ø—Ä–æ—Å–∞—Ö c VM, –µ—Å–ª–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–π –¥–æ–º–µ–Ω –Ω–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ <code>.ru</code> –∏–ª–∏ <code>.com</code>.</p>
<blockquote>
<p><strong>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞.</strong> –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ.</p>
</blockquote>
</li>
<li>
<p>–ù–∏ –æ —á–µ–º –¥—Ä—É–≥–æ–º IDS –æ–ø–æ–≤–µ—â–∞—Ç—å –Ω–µ –¥–æ–ª–∂–Ω–∞.</p>
</li>
<li>–ö–∞–∂–¥—ã–π —Ç–∏–ø –æ–ø–æ–≤–µ—â–µ–Ω–∏—è –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–≤–æ–π <code>classtype</code>.</li>
<li>–ü—Ä–∞–≤–∏–ª–∞ –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ —Ñ–∞–π–ª–µ <code>&lt;your_name&gt;.rules</code>.</li>
<li>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –æ–ø–æ–≤–µ—â–µ–Ω–∏–π.</li>
<li><strong>‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–ª–ª.</strong> –° –ø–æ–º–æ—â—å—é linux-—É—Ç–∏–ª–∏—Ç—ã (–Ω–∞–π—Ç–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ) –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π web-—Å–µ—Ä–≤–µ—Ä –∏ IPS-—Å–∏—Å—Ç–µ–º—É –Ω–∞ DoS-–∞—Ç–∞–∫—É. –ü–æ–¥–æ–±—Ä–∞—Ç—å —Ç–∞–∫–æ–π —Ä–µ–∂–∏–º –∏ –ø—Ä–∞–≤–∏–ª–∞ IPS, —á—Ç–æ–±—ã DoS-–∞—Ç–∞–∫–∞ –±—ã–ª–∞ –ø—Ä–µ—Å–µ—á–µ–Ω–∞.</li>
<li><strong>‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–∞–ª–ª.</strong> –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Suricata –≤ —Ä–µ–∂–∏–º–µ IPS –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤.</li>
</ol>
</li>
</ol>
<h3 id="_15">ü§î –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h3>
<ol>
<li>–°–∫–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª –≤ —Ñ–∞–π–ª–µ <code>suricata.rules</code>?</li>
<li>–ò–∑ –∫–∞–∫–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–æ–ª–∂–Ω—ã –≤—ã–±–∏—Ä–∞—Ç—å—Å—è –∑–Ω–∞—á–µ–Ω–∏—è <code>sid</code> –¥–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø—Ä–∞–≤–∏–ª?</li>
<li>–í —á–µ–º –æ—Ç–ª–∏—á–∏–µ IPS –∏ IDS —Ä–µ–∂–∏–º–∞?</li>
<li>–ö–∞–∫–∏–µ –º–µ—Ç–∞-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –ø—Ä–∞–≤–∏–ª–µ —è–≤–ª—è—é—Ç—Å—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏?</li>
<li>–ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å <code>tail -f &lt;–ª–æ–≥-—Ñ–∞–π–ª&gt;</code>?</li>
<li>–ö–∞–∫–∏–º–∏ –ø–∞–∫–µ—Ç–∞–º–∏ –æ–±–º–µ–Ω–∏–≤–∞—é—Ç—Å—è –∫–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ HTTP?</li>
</ol>
<style>
    .copyright {
        color: gray;
        font-size: 0.6rem;
    }
</style>

<div class="copyright">

<hr>

–ò—Å–ø–æ–ª—å–∑—É—è –¥–∞–Ω–Ω—ã–π —Å–∞–π—Ç –∏ –µ–≥–æ —Ä–µ—Å—É—Ä—Å—ã, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å <a href=/policy/> –ø–æ–ª–∏—Ç–∏–∫–æ–π –∏ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è–º–∏ —Å–∞–π—Ç–∞</a>.<br>

¬©Ô∏è –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ, –∏–∑–ª–æ–∂–µ–Ω–∏–µ, –º–µ–¥–∏–∞–º–∞—Ç–µ—Ä–∏–∞–ª—ã. –ò. –ü–æ–ø–æ–≤, 2020-2025<br>

–°–¥–µ–ª–∞–Ω–æ —Å –ø–æ–º–æ—â—å—é Material for MkDocs.<br>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>